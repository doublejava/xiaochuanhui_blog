# 博客部署到Netlify详细步骤

## 准备工作

1. **确保本地构建正常**
   ```bash
   # 在项目根目录执行构建命令
   npm run build
   ```
   构建成功后，检查 `docs/.vitepress/dist` 目录是否生成，确保包含所有静态文件。

2. **将代码推送到GitHub**
   ```bash
   # 初始化Git仓库（如果尚未初始化）
   git init
   git add .
   git commit -m "Initial commit"
   
   # 添加远程仓库
   git remote add origin https://github.com/doublejava/xiaochuanhui_blog.git
   
   # 推送代码
   git push -u origin main
   ```

## Netlify部署步骤

### 1. 注册/登录Netlify

访问 [Netlify官网](https://www.netlify.com/)，使用GitHub账号登录。

### 2. 新建站点

1. 点击 "Add new site" → "Import an existing project"
2. 选择 "GitHub" 作为Git提供商
3. 授权Netlify访问你的GitHub仓库
4. 选择你要部署的仓库 `doublejava/xiaochuanhui_blog`

### 3. 配置构建设置

**关键配置（必须正确设置！）**：

| 配置项 | 值 | 说明 |
|--------|-----|------|
| Build command | `npm run build` | VitePress构建命令 |
| Publish directory | `docs/.vitepress/dist` | 构建输出目录，**注意：不是docs/dist** |
| Base directory | 留空 | 项目根目录 |

### 4. 部署站点

1. 点击 "Deploy site" 开始部署
2. Netlify将自动执行构建命令并部署到其CDN
3. 部署成功后，Netlify会分配一个随机域名（如 `https://xxxxxxx.netlify.app`）

## 配置自定义域名（可选）

1. 在Netlify控制台，进入站点设置 → "Domain management"
2. 点击 "Add custom domain"，输入你的域名
3. 按照Netlify提示，在域名注册商处配置DNS解析

## 常见问题排查

### 1. 部署失败：Deploy directory 'docs/dist' does not exist

**问题原因**：Netlify默认使用 `docs/dist` 作为发布目录，但VitePress实际构建输出到 `docs/.vitepress/dist`

**解决方案**：在构建设置中修改Publish directory为 `docs/.vitepress/dist`

### 2. 部署成功但CSS/JS文件404

**问题原因**：
- 发布目录配置错误
- 站点base路径配置问题
- 构建输出目录结构不正确

**解决方案**：
1. 确认Publish directory设置为 `docs/.vitepress/dist`
2. 检查 `.vitepress/config.ts` 中的base配置：
   ```typescript
   // 如果是部署到GitHub Pages的子路径，需要配置base
   // 如果是Netlify根域名，base应为'/'
   export default defineConfig({
     base: '/',
     // ...
   })
   ```
3. 重新构建并部署

### 3. 构建失败：npm install失败

**解决方案**：
- 确保项目根目录有 `package.json` 文件
- 检查依赖项是否正确配置
- 尝试在本地执行 `npm install` 确保依赖安装正常

## 自动化部署

Netlify会自动监听GitHub仓库的main分支，当有新的推送时，会自动触发构建和部署。

### 查看部署历史

在Netlify控制台，进入 "Deploys" 选项卡，可以查看所有部署历史记录，包括构建日志和状态。

## 本地预览构建结果

```bash
# 构建并预览
npm run build && npm run preview
```

通过 `http://localhost:4173` 可以本地预览构建后的站点，确保与Netlify部署效果一致。

## 总结

1. 确保本地构建正常，生成 `docs/.vitepress/dist` 目录
2. 将代码推送到GitHub
3. 在Netlify上配置正确的构建命令和发布目录
4. 部署站点并验证访问
5. 配置自定义域名（可选）

通过以上步骤，你可以成功将VitePress博客部署到Netlify，并确保CSS/JS等静态资源正常加载。